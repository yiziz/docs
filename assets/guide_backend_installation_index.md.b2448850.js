import{_ as e,c as n,a as s,b as l,t as o,d as t,o as p}from"./app.e3d84d55.js";const b=JSON.parse('{"title":"Installation","description":"","frontmatter":{"title":"Installation"},"headers":[{"level":2,"title":"Add the Maven dependency","slug":"add-the-maven-dependency"},{"level":3,"title":"Dependencies","slug":"dependencies"},{"level":2,"title":"Configure ClientLibs","slug":"configure-clientlibs"},{"level":3,"title":"Update your template(s)","slug":"update-your-template-s"},{"level":3,"title":"Add esModule HTL binding","slug":"add-esmodule-htl-binding"},{"level":3,"title":"Add esModule ClientLib property","slug":"add-esmodule-clientlib-property"}],"relativePath":"guide/backend/installation/index.md","lastUpdated":1656664739000}'),c={name:"guide/backend/installation/index.md"},r={id:"frontmatter-title",tabindex:"-1"},i=s("a",{class:"header-anchor",href:"#frontmatter-title","aria-hidden":"true"},"#",-1),d=t(`<div class="warning custom-block"><p class="custom-block-title">Deprecation Notice</p><p>Please be aware that the ClientLib filtering functionality in the AEM Vite plugin for AEM is now deprecated and will be discontinued in the near future. A Vite specifc plugin will be made available that enhances the local development experience. See <a href="./../../front-end/vite-plugin/">Vite Plugin</a> for additional information.</p></div><p>Installation is straightforward and easy. Please ensure your read the below carefully as some manual steps are needed to finish the installation.</p><h2 id="add-the-maven-dependency" tabindex="-1">Add the Maven dependency <a class="header-anchor" href="#add-the-maven-dependency" aria-hidden="true">#</a></h2><p>Add the <code>aem-vite.all</code> package as a Maven dependency in your apps <code>pom.xml</code> file.</p><div class="language-xml"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">dev.aemvite</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">aem-vite.all</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">2.2.1</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">version</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dependency</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>Next, add the following to your <a href="https://jackrabbit.apache.org/filevault/overview.html" target="_blank" rel="noopener noreferrer">FileVault</a> configuration; remembering to change the <code>&lt;target&gt;</code> path to suit your project structure.</p><div class="language-xml"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">embedded</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">dev.aemvite</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">groupId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">aem-vite.all</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">artifactId</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">zip</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">target</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/apps/\${appId}-packages/application/install</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">target</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">embedded</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>This will typically be added to your <strong>all</strong> module or <strong>ui.apps</strong> if you don&#39;t have an <strong>all</strong> module.</p></div><h3 id="dependencies" tabindex="-1">Dependencies <a class="header-anchor" href="#dependencies" aria-hidden="true">#</a></h3><p>AEM Vite doesn&#39;t rely on any 3rd-party dependencies and only makes use of API&#39;s available in the AEM Uber JAR and Cloud SDK.</p><h2 id="configure-clientlibs" tabindex="-1">Configure ClientLibs <a class="header-anchor" href="#configure-clientlibs" aria-hidden="true">#</a></h2><p>As Vite natively builds ES modules by default, it is important to have AEM generate <code>&lt;script module&gt;</code> tags for your ClientLibs.</p><h3 id="update-your-template-s" tabindex="-1">Update your template(s) <a class="header-anchor" href="#update-your-template-s" aria-hidden="true">#</a></h3><p>The first change needed will be switch from the built-in <code>clientlib.html</code> HTL template to the AEM Vite template. Start by opening all of your page components/templates and change:</p><div class="language-html"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">sly</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">data-sly-use.clientlib</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/libs/granite/sightly/templates/clientlib.html</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">sly</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>to</p><div class="language-html"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">sly</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">data-sly-use.clientlib</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/apps/aem-vite/granite/sightly/templates/clientlib.html</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">sly</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="add-esmodule-htl-binding" tabindex="-1">Add <code>esModule</code> HTL binding <a class="header-anchor" href="#add-esmodule-htl-binding" aria-hidden="true">#</a></h3><p>Within the same file(s), locate all your <code>data-sly-call</code> instances for <code>clientlib.&lt;type&gt;</code> where <code>&lt;type&gt;</code> refers to <strong>all</strong> or <strong>js</strong>. Update all instances where you require ES module support. Adding the <code>esModule</code> binding won&#39;t automatically enable ES modules which you will need to enable in the next step.</p><div class="language-html"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">sly</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">data-sly-test</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\${clientLibCategoriesJsHead}</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">data-sly-call</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\${clientlib.js @ categories=clientLibCategoriesJsHead, esModule=true}</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">sly</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="add-esmodule-clientlib-property" tabindex="-1">Add <code>esModule</code> ClientLib property <a class="header-anchor" href="#add-esmodule-clientlib-property" aria-hidden="true">#</a></h3><p>Next, open your ClientLibs folder/configuration and after <code>allowProxy</code> add the <code>esModule</code> property which instructs the custom ClientLibs handler in AEM Vite to generate <code>&lt;script&gt;</code> tags with the <code>module</code> attribute.</p><p>See the example below.</p><div class="language-xml"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">jcr</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">root</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">cq</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.day.com/jcr/cq/1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">jcr</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.jcp.org/jcr/1.0</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">jcr</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">primaryType</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cq:ClientLibraryFolder</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">allowProxy</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">{Boolean}true</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">esModule</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">{Boolean}true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/&gt;</span></span>
<span class="line"></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">Please Note</p><p>Only add the <code>esModule</code> property to ClientLibs that will be consuming ES bundles generated by Vite. Adding it to non-ES modules won&#39;t break things in general but is not recommended.</p></div>`,25);function y(a,D,F,u,g,h){return p(),n("div",null,[s("h1",r,[l(o(a.$frontmatter.title)+" ",1),i]),d])}var C=e(c,[["render",y]]);export{b as __pageData,C as default};
