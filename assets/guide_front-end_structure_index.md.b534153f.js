import{o as t,c as e,a,b as s,t as n,d as o}from"./app.45dd6989.js";const p='{"title":"Structure","description":"","frontmatter":{"title":"Structure"},"headers":[{"level":2,"title":"ClientLibs","slug":"clientlibs"},{"level":3,"title":"Configuration","slug":"configuration"},{"level":3,"title":"js.txt handling","slug":"js-txt-handling"},{"level":2,"title":"Template policy(s)","slug":"template-policy-s"}],"relativePath":"guide/front-end/structure/index.md","lastUpdated":1622607265445}',l={},c={id:"frontmatter-title"},r=a("a",{class:"header-anchor",href:"#frontmatter-title","aria-hidden":"true"},"#",-1),i=o('<p>Considerations about varying project structures have been taken into account as much as possible. Examples can only provide so much detail so the below is what is considered best-case for AEM Vite.</p><h2 id="clientlibs"><a class="header-anchor" href="#clientlibs" aria-hidden="true">#</a> ClientLibs</h2><p>The ideal structure recommended for ClientLibs is as below.</p><div class="language-"><pre><code>/apps/&lt;project&gt;/clientlibs/core.header/\n/apps/&lt;project&gt;/clientlibs/core.header/resources/\n/apps/&lt;project&gt;/clientlibs/core.header/css.txt\n/apps/&lt;project&gt;/clientlibs/core.header/js.txt\n/apps/&lt;project&gt;/clientlibs/core.footer/\n/apps/&lt;project&gt;/clientlibs/core.footer/resources/\n/apps/&lt;project&gt;/clientlibs/core.footer/js.txt\n</code></pre></div><p>A structure such as this allows us to accomplish two key things:</p><ol><li>Separation of header CSS &amp; JS</li><li>Non-blocking JavaScript which loads after the DOM has been loaded</li></ol><h3 id="configuration"><a class="header-anchor" href="#configuration" aria-hidden="true">#</a> Configuration</h3><p>Here is how each ClientLib would be configured.</p><table><thead><tr><th>ClientLib Category</th><th>allowProxy</th><th>esModule</th><th>css.txt</th><th>js.txt</th></tr></thead><tbody><tr><td><code>&lt;project&gt;.core.header</code></td><td><code>true</code></td><td><code>true</code></td><td>Yes</td><td>Yes</td></tr><tr><td><code>&lt;project&gt;.core.footer</code></td><td><code>true</code></td><td><code>true</code></td><td>No</td><td>Yes</td></tr></tbody></table><h3 id="js-txt-handling"><a class="header-anchor" href="#js-txt-handling" aria-hidden="true">#</a> js.txt handling</h3><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>v2.x and newer use a different method of generating the ClientLib path. Please read the below carefully to fully understand this change.</p></div><p>To ensure circular imports don&#39;t cause issues when your code is bundled, AEM Vite now uses the <code>js.txt</code> file to resolve the ClientLib path. For example:</p><div class="language-"><pre><code>resources/js/app.js\n</code></pre></div><p>Keep in mind that the path you add to <code>js.txt</code> needs to be your entry file. At this time multiple entry points are not supported but may be in the future.</p><h2 id="template-policy-s"><a class="header-anchor" href="#template-policy-s" aria-hidden="true">#</a> Template policy(s)</h2><p>Your template policy(s) will also need to be updated to support this structure. The below is an example of how to achieve this.</p><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>page</span> <span class="token attr-name"><span class="token namespace">jcr:</span>primaryType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nt:unstructured<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>policy</span>\n    <span class="token attr-name"><span class="token namespace">jcr:</span>primaryType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nt:unstructured<span class="token punctuation">&quot;</span></span>\n    <span class="token attr-name"><span class="token namespace">sling:</span>resourceType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wcm/core/components/policy/policy<span class="token punctuation">&quot;</span></span>\n    <span class="token attr-name">clientlibs</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[&lt;project&gt;.core.header,&lt;project&gt;.core.footer]<span class="token punctuation">&quot;</span></span>\n    <span class="token attr-name">clientlibsJsHead</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[&lt;project&gt;.core.header]<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>page</span><span class="token punctuation">&gt;</span></span>\n</code></pre></div>',17);l.render=function(o,p,l,u,d,h){return t(),e("div",null,[a("h1",c,[r,s(" "+n(o.$frontmatter.title),1)]),i])};export default l;export{p as __pageData};
