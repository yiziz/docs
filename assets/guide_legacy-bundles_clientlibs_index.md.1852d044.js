import{o as t,c as e,a,b as o,t as s,d as n}from"./app.678b45c3.js";const c='{"title":"ClientLibs Support","description":"","frontmatter":{"title":"ClientLibs Support"},"headers":[{"level":2,"title":"Update your template policy","slug":"update-your-template-policy"},{"level":2,"title":"How to test that things work?","slug":"how-to-test-that-things-work"},{"level":2,"title":"What if I don\'t want ES modules?","slug":"what-if-i-don-t-want-es-modules"}],"relativePath":"guide/legacy-bundles/clientlibs/index.md","lastUpdated":1623590753684}',r={},p={id:"frontmatter-title"},d=a("a",{class:"header-anchor",href:"#frontmatter-title","aria-hidden":"true"},"#",-1),l=n('<p>A simple solution to this problem would be to have another separate ClientLib structure containing only <code>js.txt</code>. Each ClientLib directory would have a unique name as outlined below.</p><table><thead><tr><th>ClientLib Category</th><th><code>esModule</code></th><th><code>noModule</code></th><th><code>css.txt</code></th><th><code>js.txt</code></th></tr></thead><tbody><tr><td><code>&lt;project&gt;.core.footer.es</code></td><td><code>true</code></td><td><code>false</code></td><td>Yes</td><td>Yes</td></tr><tr><td><code>&lt;project&gt;.core.header.es</code></td><td><code>true</code></td><td><code>false</code></td><td>Yes</td><td>Yes</td></tr><tr><td><code>&lt;project&gt;.core.footer.legacy</code></td><td><code>false</code></td><td><code>true</code></td><td>No</td><td>Yes</td></tr><tr><td><code>&lt;project&gt;.core.header.legacy</code></td><td><code>false</code></td><td><code>true</code></td><td>No</td><td>Yes</td></tr></tbody></table><p>There is no real importance to how you name your ClientLibs as the order of how they get output is determined by your template policy.</p><h2 id="update-your-template-policy"><a class="header-anchor" href="#update-your-template-policy" aria-hidden="true">#</a> Update your template policy</h2><p>It is important that in the above example that <code>&lt;project&gt;.core.header.es</code> is generated first in the page source. To ensure this is the case, make sure your template policy is similar to the below.</p><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>page</span> <span class="token attr-name"><span class="token namespace">jcr:</span>primaryType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nt:unstructured<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>policy</span>\n    <span class="token attr-name"><span class="token namespace">jcr:</span>primaryType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nt:unstructured<span class="token punctuation">&quot;</span></span>\n    <span class="token attr-name"><span class="token namespace">sling:</span>resourceType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wcm/core/components/policy/policy<span class="token punctuation">&quot;</span></span>\n    <span class="token attr-name">clientlibs</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[&lt;project&gt;.core.header.es,&lt;project&gt;.core.footer.es,&lt;project&gt;.core.header.legacy,&lt;project&gt;.core.footer.legacy]<span class="token punctuation">&quot;</span></span>\n    <span class="token attr-name">clientlibsJsHead</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[&lt;project&gt;.core.header.es,&lt;project&gt;.core.header.legacy]<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>page</span><span class="token punctuation">&gt;</span></span>\n</code></pre></div><p>This will vary from project-to-project, use the above as a guide only.</p><h2 id="how-to-test-that-things-work"><a class="header-anchor" href="#how-to-test-that-things-work" aria-hidden="true">#</a> How to test that things work?</h2><p>Open DevTools in your browser and navigate to the Network tab (or equivalent). Refresh the page and filter by JS files. You should observe ClientLibs loading from <code>core.header.es</code> when using a modern browser otherwise <code>core.header.legacy</code>.</p><h2 id="what-if-i-don-t-want-es-modules"><a class="header-anchor" href="#what-if-i-don-t-want-es-modules" aria-hidden="true">#</a> What if I don&#39;t want ES modules?</h2><p>Easy!</p><p>Simply have Vite build only legacy bundles by using the <a href="https://vitejs.dev/config/#build-target" target="_blank" rel="noopener noreferrer"><code>build.target</code> config option</a>. From the above, simply omit <code>core.header.es</code> and <code>core.footer.es</code> and ensure your <code>core.header.legacy</code> ClientLib contains both a <code>css.txt</code> and <code>js.txt</code> file.</p><p>Both the <code>esModule</code> and <code>noModule</code> properties won&#39;t be required in this case since we are no longer working with an ES module.</p>',13);r.render=function(n,c,r,i,u,h){return t(),e("div",null,[a("h1",p,[d,o(" "+s(n.$frontmatter.title),1)]),l])};export default r;export{c as __pageData};
