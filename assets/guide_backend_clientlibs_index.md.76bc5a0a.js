import{_ as a,c as l,a as s,b as n,t as o,d as t,o as p}from"./app.54844076.js";const b=JSON.parse('{"title":"ClientLibs","description":"","frontmatter":{"title":"ClientLibs"},"headers":[{"level":3,"title":"Update your page component(s)","slug":"update-your-page-component-s","link":"#update-your-page-component-s","children":[]},{"level":3,"title":"Add esModule HTL binding","slug":"add-esmodule-htl-binding","link":"#add-esmodule-htl-binding","children":[]},{"level":3,"title":"Add esModule ClientLib property","slug":"add-esmodule-clientlib-property","link":"#add-esmodule-clientlib-property","children":[]}],"relativePath":"guide/backend/clientlibs/index.md","lastUpdated":1675212307000}'),c={name:"guide/backend/clientlibs/index.md"},r={id:"frontmatter-title",tabindex:"-1"},i=s("a",{class:"header-anchor",href:"#frontmatter-title","aria-hidden":"true"},"#",-1),d=t(`<p>As Vite natively builds ES modules by default, it is important to have AEM generate <code>&lt;script module&gt;</code> tags for your ClientLibs.</p><h3 id="update-your-page-component-s" tabindex="-1">Update your page component(s) <a class="header-anchor" href="#update-your-page-component-s" aria-hidden="true">#</a></h3><p>The first change needed will be switch from the built-in <code>clientlib.html</code> HTL component to the AEM Vite template. Start by opening all of your page components and change:</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">sly</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">data-sly-use.clientlib</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/libs/granite/sightly/templates/clientlib.html</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">sly</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>to</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">sly</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">data-sly-use.clientlib</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/apps/aem-vite/granite/sightly/templates/clientlib.html</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">sly</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="add-esmodule-htl-binding" tabindex="-1">Add <code>esModule</code> HTL binding <a class="header-anchor" href="#add-esmodule-htl-binding" aria-hidden="true">#</a></h3><p>Within the same file(s), locate all your <code>data-sly-call</code> instances for <code>clientlib.&lt;type&gt;</code> where <code>&lt;type&gt;</code> refers to <strong>all</strong> or <strong>js</strong>. Update all instances where you require ES module support. Adding the <code>esModule</code> binding won&#39;t automatically enable ES modules which you will need to enable in the next step.</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">sly</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">data-sly-test</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\${clientLibCategoriesJsHead}</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">data-sly-call</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">\${clientlib.js @ categories=clientLibCategoriesJsHead, esModule=true}</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">sly</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><h3 id="add-esmodule-clientlib-property" tabindex="-1">Add <code>esModule</code> ClientLib property <a class="header-anchor" href="#add-esmodule-clientlib-property" aria-hidden="true">#</a></h3><p>Next, open your ClientLibs folder/configuration and after <code>allowProxy</code> add the <code>esModule</code> property which instructs the custom ClientLibs handler in AEM Vite to generate <code>&lt;script&gt;</code> tags with the <code>module</code> attribute.</p><p>See the example below.</p><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">jcr</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;">root</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">cq</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.day.com/jcr/cq/1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">jcr</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://www.jcp.org/jcr/1.0</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">jcr</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">primaryType</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cq:ClientLibraryFolder</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">allowProxy</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">{Boolean}true</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#C792EA;">esModule</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">{Boolean}true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/&gt;</span></span>
<span class="line"></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">Please Note</p><p>Only add the <code>esModule</code> property to ClientLibs that will be consuming ES bundles generated by Vite. Adding it to non-ES modules won&#39;t break things in general but is not recommended.</p></div>`,14);function y(e,D,F,u,h,g){return p(),l("div",null,[s("h1",r,[n(o(e.$frontmatter.title)+" ",1),i]),d])}const C=a(c,[["render",y]]);export{b as __pageData,C as default};
